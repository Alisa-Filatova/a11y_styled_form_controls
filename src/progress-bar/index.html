<!doctype html>
<html lang="en" class="no-js">
	<head>
		<meta charset="utf-8">
		<title>
			Styled Progress Bar
		</title>
		<meta name="viewport"
			content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<script>
			// remove no-js and add 'js' to the HTML
			document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
		</script>
		<link rel="stylesheet" href="../assets/css/--demo-only--.css">
		<link rel="stylesheet" href="../assets/css/--shared--.css">
		<link rel="stylesheet" href="../assets/css/progress-bar.css">
	</head>
	<body>

		<div class="demo-wrap">

			<header class="demo-wrap__header">
				<p class="demo-wrap__header__title">
					Accessible Styled Form Controls
				</p>
				<nav>
					<a href="https://github.com/scottaohara/a11y_styled_form_controls">See source on GitHub</a>,
					<a href="/a11y_styled_form_controls">Index of styled form controls</a>
				</nav>
			</header>

			<main aria-label="content">
				<article class="demo">
					<header>
						<h1>Styled Progress Bar</h1>
						<p>Last updated: <time>July 26, 2018</time></p>
						<p>
							Cross-browser styling for the HTML progress bar.
						</p>
					</header>

					<h2>
						Pattern Demo
					</h2>

					<div class="progress-meter-example">
						<label for="tasks_comp">
							Tasks Completed:
							<progress id="tasks_comp" value="50" max="100"></progress>
						</label>
					</div>

					<div class="progress-meter-example">
						<span id="file_status">
							File Uploaded:
						</span>
						<progress aria-labelledby="file_status" value="70" max="100"></progress>
					</div>

					<div class="progress-meter-example">
						<progress aria-label="Delivery Status" value="80" max="100"></progress>
					</div>

					<hr>
					ARIA
					<div role="progressbar"
						aria-valuenow="20"
						aria-valuemin="0"
						aria-valuetext="Step 2: Copying files... "
						aria-valuemax="100">
					  Step 2: Copying files...
					</div>

					<hr>

					<div class="progress-meter-example">
						<label for="tasks_comp2">
							Tasks Completed:
							<progress class="style" id="tasks_comp2" value="50" max="100"></progress>
						</label>
					</div>

					<div class="progress-meter-example">
						<span id="file_status2">
							File Uploaded:
						</span>
						<progress class="style" aria-labelledby="file_status2" value="70" max="100"></progress>
					</div>

					<div class="progress-meter-example">
						<progress class="style" aria-label="Delivery Status" value="80" max="100"></progress>
					</div>

					<section class="demo-details">
						<h3>
							Pattern Details
						</h3>

						<details open>
							<summary>Pattern Markup</summary>
							<pre><code class="language-html">&lt;label for="tasks_comp">
	Tasks Completed:
	&lt;progress id="tasks_comp" value="50" max="100">&lt;/progress>
&lt;/label>

&lt;span id="file_status">
	File Uploaded:
&lt;/span>
&lt;progress aria-labelledby="file_status" value="70" max="100">&lt;/progress>

&lt;progress aria-label="Delivery Status" value="80" max="100">&lt;/progress></code></pre>

						</details>

						<p>
							Unlike many other form controls, a <code>progress</code> element is cannot be directly modified by a user, though a <code>progress</code> element is often used to indicate the completion status of a task initiated by a user.
						</p>
						<p>
							A task can refer to user flows, like a user's current progress in a sign up flow, or a task being performed by an application, or server. For example, using a progress bar to indicate the application updating after a form submission, or indicating the progress of a file upload within an application's UI.
						</p>

						<p>
							For indicating the state of a finite gauge, such as available diskspace, a <a href="../meter"><code>meter</code></a> would be more appropriate.
						</p>

						<h4>Styling a <code>progress</code> element</h4>

						<p>
							The <code>progress</code> element has support in all modern browsers, including Internet Explorer. The only catch to styling it is it requires the use of vendor prefixed selectors. Though, compared to the <a href="../range-slider"><code>range</code> element</a>, there aren't that many to worry about.
						</p>

						<p>Largely the prefixed selectors to be concerned with are the following:</p>

						<dl>
							<dt><code>::-webkit-progress-bar</code></dt>
							<dd>why...</dd>
							<dt><code>::-ms-fill</code></dt>
							<dd>why...</dd>
							<dt><code>::-moz-progress-bar</code></dt>
							<dd>why...</dd>
							<dt><code>::-webkit-progress-value</code></dt>
							<dd>why...</dd>
						</dl>

						<p>
							Additionally there are the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-progress-inner-element" title="on MDN web docs"><code>::-webkit-progress-inner-element</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:indeterminate" title="on MDN web docs"><code>:indeterminate</code></a> selectors. But they are not used for the styled <code>progress</code> elements shown here.
						</p>

						<h4>Affects on Screen Reader Announcements?</h4>

						<p>
							Styling a <code>progress</code> element will alter the way a progress bar is announced by VoiceOver on macOS High Sierra + Safari. It doesn't seem to matter what rules are applied to it, but once the visual style is altered from the default, VoiceOver will dissociate an accessible name, provided by a <code>label</code> element. If an accessible name is set via <code>aria-label</code>, VoiceOver will announce a progress bar as a <code>role="group</code>, and then require a second focus stop to access the state of the progress bar.
						</p>

						<p>
							macOS VoiceOver + Chrome doesn't fair much better, as styled progress bars do not become groups, but are announced as "indeterminate progress indicator" regardless of their set <code>value</code>.
						</p>


						<p>
							Note: progress bars are not meant to be focusable elements, so the following tests were performed with the virtual cursor.
						</p>

						<dl>
							<dt>
								JAWS 2018 + Firefox 63 (nightly)
							</dt>
							<dd>
								A styled progress bar with
							</dd>

							<dt>
								JAWS 2018 + Chrome (latest)
							</dt>
							<dd>
								Regardless of the pattern, a styled progress bar is completely ignored by JAWS + Chrome.
							</dd>

							<dt>
								NVDA 2018.2.1 + Firefox 63 (nightly)
							</dt>
							<dd>
								A styled progress bar with
							</dd>

							<dt>
								NVDA 2018.2.1 + Chrome (latest)
							</dt>
							<dd>
								<p>
									When NVDA virtual cursor focuses a progress bar with an accessible name provided by a <code>label</code>, NVDA will announce:
								</p>
								<p>
									<q>[Accessible name (from visible label)], progress bar 50</q>
								</p>
								<p>
									If an accessible name is provided by an <code>aria-label</code> or <code>aria-labelledby</code> then NVDA will ignore the current value and announce the accessible name in place of the value.
								</p>
								<p>
									<q>[Accessible name (from visible label)], progress bar [Accessible name (from <code>aria-label</code> or <code>aria-labelledby</code>)]</q>
								</p>
							</dd>



							<dt>VoiceOver + Safari 11.1.1 on macOS High Sierra</dt>
							<dd>...</dd>


							<dt>VoiceOver + Safari on iOS 11.4</dt>
							<dd>
								Regardless of the pattern, a styled progress bar is completely ignored by JAWS + Chrome.
							</dd>
						</dl>


						<h4>Usage note:</h4>
						<p>
							Though the <code>progress</code> element is reporting the correct information to browsers, screen readers have quite a few kinks in how they announce that information to users.
						</p>
						<p>
							At the time of testing, it appears the best manner in which to provide a progress bar an accessible name is by using the native <code>label</code> element.
						</p>


					</section>
				</article> <!-- /.demo -->
			</main>
		</div> <!-- /.demo-wrap -->
		<script>
			var highlighterCSS = function () {
			  var head = document.head;
			  var link = document.createElement('link');

			  link.rel = 'stylesheet';
			  link.href = '../assets/vendor/prism.css';

			  head.appendChild(link);
			}

			highlighterCSS();
		</script>
		<script src="../assets/vendor/prism.js"></script>
	</body>
</html>
