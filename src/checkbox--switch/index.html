<!doctype html>
<html lang="en" class="no-js">
	<head>
		<meta charset="utf-8">
		<title>
			Switch Component: Checkbox
		</title>
		<meta name="viewport"
			content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<script>
			// remove no-js and add 'js' to the HTML
			document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
		</script>
		<link rel="stylesheet" href="../assets/css/--demo-only--.css">
		<link rel="stylesheet" href="../assets/css/--shared--.css">
		<link rel="stylesheet" href="../assets/css/switch--checkbox.css">
		<link rel="stylesheet" href="../assets/css/switch--checkbox--alt.css">
	</head>
	<body>

		<div class="demo-wrap">

			<header class="demo-wrap__header">
				<h1>Switch Component: Checkbox</h1>
				<p>
					Pattern to modify a <code>checkbox</code> into a <code>switch</code> component.
				</p>
				<nav>
					<a href="https://github.com/scottaohara/a11y_styled_form_controls">See source on GitHub</a>,
					<a href="/a11y_styled_form_controls">Index of form controls</a>
				</nav>
			</header>

			<main>

				<article class="demo">
					<h2>
						Pattern Demo
					</h2>

					<form>
						<p style="margin-bottom: .25em">
							Version: <code>[type="checkbox"]</code> styled to look like a switch
						</p>
						<label class="check-switch" for="switch_1">
							Example Text 1:
							<input type="checkbox" id="switch_1" data-switch>
							<span aria-hidden="true"></span>
						</label>

						<p style="margin-bottom: .25em">
							Version: <code>[type="checkbox"][role="switch"]</code>
						</p>
						<label class="check-switch" for="switch_2">
							Example Text 2:
							<input type="checkbox" id="switch_2" data-switch>
							<span aria-hidden="true"></span>
						</label>

						<p style="margin-bottom: .25em">
							Version: <code>[type="checkbox"][role="switch"]</code> - Alternate Markup/Style
						</p>
						<!--
							Based on pattern by Richard Keizer: https://codepen.io/rakeizer/pen/QQRBoZ
						-->
						<div class="switchbox">
							<label for="switchbox">
								Example Text 3:
							</label>
							<input type="checkbox" id="switchbox" data-switch>
						</div>
					</form>
					<p>
						<details>
							<summary>Visual design note</summary>
							<div>
								<p>
									<code>-moz-appearance: none;</code> does not completely remove the styling
									from the checkbox in Firefox ESR. (works as expected in Firefox 60+).
								</p>
								<p>
									The <code>box-shadow</code> to provide an outline of the control does not
									render as expected in IE11, but works as expected in Edge.
								</p>
							</div>
						</details>
					</p>


					<section class="demo-details">
						<h3>
							Pattern Details
						</h3>

						<details open>
							<summary>Pattern Markup</summary>
								<pre><code>&lt;!-- Version: [type="checkbox"] styled to look like a switch -->
&lt;label class="check-switch" for="switch_1">
  &lt;input type="checkbox" id="switch_1" role="switch">
  &lt;span tabindex="-1">Example Text:&lt;/span>
  &lt;!--
    the tabindex="-1" is here to negate VO
    from announcing the "example" label twice
  -->
&lt;/label>

&lt;!-- Version: [type="checkbox"][role="switch"] -->
&lt;label class="check-switch" for="switch_2">
  &lt;input type="checkbox" id="switch_2" role="switch">
  &lt;span tabindex="-1">Example Text:&lt;/span>
&lt;/label>

&lt;!--
  Version: [type="checkbox"][role="switch"]
  Alternate markup/style
-->
&lt;div class="switchbox">
  &lt;label for="switchbox">
    Label Text:
  &lt;/label>
  &lt;input type="checkbox" id="switchbox" role="switch">
&lt;/div></code></pre>
						</details>

						<p>
							Similar to the native checkbox example, a markup pattern reliant on a native checkbox form control can be used to create a custom switch control. It should be noted that a form control with the role of <code>switch</code> vs a <code>checkbox</code> role have different expectations to screen reader users.
						</p>

						<p>
							A native checkbox should be used the switch component continues to function like a checkbox. Meaning that the "switch" should not change the state of a component or alter a global site or application setting, until after a user submits the form the "switch" is a child of. A <code>role="switch"</code> should be applied to the native checkbox if activating the form control will perform an instant state change, without the need for a form submission.
						</p>

						<p>
							If using a visually styled switch in a website or application, it should only adhere to one of the previously mentioned roles. It should announce itself as a "switch" or a "checkbox", and this announcement, and its behavior, should be consistent across all instances of the component.
						</p>

						<p>
							A small script is used to progressively enhance a checkbox <code>input</code> with a <code>data-switch</code> into a <code>role="switch"</code>. The script also allows for the <kbd>Enter</kbd> key to be used to toggle the state of the switch, as checkboxes would otherwise only allow for the <kbd>Space</kbd> key to toggle their state.
						</p>

						<h4>Affects on Screen Reader Announcements?</h4>
						<p>
							Giving the <code>input type="checkbox"</code> a <code>role="switch"</code> announces the form control as a "switch" or "toggle button" to screen readers that support the role, and indicate the element's state as "on/checked" or "off/not checked".
						</p>

						<p>
							Unfortunately, there are still some gaps in support for this <code>role</code>.  VoiceOver on iOS 11.3 and 11.3.1 doesn't understand the role and will fallback to announcing the component as a checkbox. However, this fallback is bugged, as the state of the checkbox will not be announced to users on toggle of the component.
						</p>

						<p>
							Similarly, JAWS2018 + IE11 will announce the form control as a <code>switch</code>, but is inconsistent with announcing the state of the component. Largely only announcing state on a user first focusing the form control with by the virtual cursor navigation or <kbd>tab</kbd> key.  If activating the form control repeatedly, focus will be lost and return to an element higher up in the DOM.
						</p>

						<p>
							NVDA 2018.1 and Chrome will announce the initial state of the <code>switch</code> as not "toggle button not pressed" and will only announce the "checked" state, making no announcement if unchecking the form control.  If a <code>switch</code> has been set to checked, and a user navigates back to it, NVDA + Chrome and Firefox ESR will announce "toggle button not pressed, checked".
						</p>

						<h5>Usage note:</h5>
						<p>
							Until issues with <code>role="switch"</code> have been worked out, it may be better to use a <code>button</code> element, with state indicated by <code>aria-pressed="true/false"</code>.
						</p>

					</section> <!-- /.demo-details -->
				</article>
			</main>
		</div> <!-- /.demo-wrap -->

		<script src="../assets/js/switch-checkbox.js"></script>

	</body>
</html>
